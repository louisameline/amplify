/*!
 * Amplify Core 1.1.2
 *
 * Copyright 2011 - 2013 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 *
 * http://amplifyjs.com
 */
(function(e,t){var n=[].slice,r={};var i=e.amplify={publish:function(e){if(typeof e!=="string"){throw new Error("You must provide a valid topic to publish.")}var t=n.call(arguments,1),i,s,o,u=0,a=[],f=true;t.unshift({stopPropagation:function(){f=false}});if(!r[e]){return true}i=r[e].slice();for(o=i.length;u<o;u++){s=i[u];a.push(s.callback.apply(s.context,t));if(!f){break}}return a},subscribe:function(e,t,n,i){if(typeof e!=="string"){throw new Error("You must provide a valid topic to create a subscription.")}if(arguments.length===3&&typeof n==="number"){i=n;n=t;t=null}if(arguments.length===2){n=t;t=null}i=i||10;var s=0,o=e.split(/\s/),u=o.length,a;for(;s<u;s++){e=o[s];a=false;if(!r[e]){r[e]=[]}var f=r[e].length-1,l={callback:n,context:t,priority:i};for(;f>=0;f--){if(r[e][f].priority<=i){r[e].splice(f+1,0,l);a=true;break}}if(!a){r[e].unshift(l)}}return n},unsubscribe:function(e,t,n){if(typeof e!=="string"){throw new Error("You must provide a valid topic to remove a subscription.")}if(arguments.length===2){n=t;t=null}if(!r[e]){return}var i=r[e].length,s=0;for(;s<i;s++){if(r[e][s].callback===n){if(!t||r[e][s].context===t){r[e].splice(s,1);s--;i--}}}}}})(this);